#elan 
[[Архитектура базы данных]]
[[API]]

#depercated
# Depercated
## Методы API

Методы API делятся на группы: 
* GET - получение данных из БД
* POST - изменение или создание данных

### GET

Получает конкретные данные из базы данных от количества человек в группе до условия задачи

Используется технология long polling

#### Long polling
#дополнить 

### POST

Делится на две группы:
* Изменение текущих полей в БД
* Создание новых полей в БД

В после обработки запроса генерируется событие.

Запрос посылает в API объект json, который называется Query, определяющий то, что нужно сделать в БД

![[Схема Post запроса]]
#### Фабрика 
Класс, который на основе Query обновляет базу данных и генерирует событие, которое сигнализирует об изменении

Для каждого конкретного обновления своя фабрика

#### Query
Информация о запросе на изменение в БД, в нём указывается тип фабрики, к которой принадлежит этот запрос, его новые свойства.

#### Event bus
Синглтон. Шина событий. 
Представляет из себя интерфейс доступа к событиям, которые хранятся в БД.

**Некоторые функции:**
* При каждом новом запросе чистит старые сообщения
* Представляет события в виде вложенных коллекций по типу #дополнить
* Может отвечать на запросы типа получить все события с момента $\huge i$ или получить по тегам 
* Хранит время последнего события
#### Event
[[События в базе данных|Событие]]. 

**Смысл события** - событие может помочь динамически обновлять состояние страницы без её прямого обновления. Событие относится к некоторой группе и имеет теги

**Сайт обращается к базе данных в 2х случаях:**
* Страница загрузилась
* Произошло событие

Пример технологии long polling и событий:
```python
async def poll(events_time_from):
	polling_from = time.time()

	while time.time() - polling_from < POLLING_TIME:
		if EventBus.get_last_event_time() > get_events_from:
			return EventBus.get_event_since(events_time_from)

	return "None"
```
*Штука, которая получает все события с момента времени events_time_from*






